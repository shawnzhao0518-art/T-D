<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>T&D Autocare | 专业汽车维修与保养</title>
    <meta name="description" content="T&D Autocare——专业汽车维修、保养、钣金喷漆与轮胎服务。在线预约，透明报价，品质保证。">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./styles.css" />
    <link rel="icon" href="./logo.png" type="image/png" />

    <!-- ✅ 新增：Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>
  <body>
    <a class="skip-link" href="#main">跳到主要内容</a>

    <header class="site-header">
      <div class="container header-inner">
        <a href="#" class="brand">
          <img src="./logo.png" alt="T&D Autocare Logo" class="brand-logo" />
          <span class="brand-name">T&D Autocare</span>
        </a>

        <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav" aria-label="打开菜单">
          <span class="bar"></span><span class="bar"></span><span class="bar"></span>
        </button>

        <nav id="site-nav" class="site-nav" aria-label="主导航">
          <ul>
            <li><a href="#services" data-i18n="nav_services">服务项目</a></li>
            <li><a href="#about" data-i18n="nav_about">关于我们</a></li>
            <li><a href="#contact" data-i18n="nav_contact">联系我们</a></li>
            <li><a class="btn btn-primary" href="#booking" data-i18n="nav_booking">在线预约</a></li>
          </ul>
        </nav>

        <button id="lang-toggle" class="lang-toggle" aria-label="切换语言">EN / 中文</button>
      </div>
    </header>

    <main id="main">
      <section class="hero">
        <div class="container hero-inner">
          <div class="hero-copy">
            <h1 data-i18n="hero_title">专业汽车维修与保养</h1>
            <p data-i18n="hero_desc">透明报价 · 原厂标准 · 快速交付。每一次服务，都让您更放心。</p>
            <div class="hero-cta">
              <a class="btn btn-primary" href="#booking" data-i18n="hero_cta_primary">立即预约</a>
              <a class="btn btn-outline" href="#services" data-i18n="hero_cta_secondary">了解服务</a>
            </div>
            <ul class="badges">
              <li data-i18n="hero_badge1">一年/20,000公里质保</li>
              <li data-i18n="hero_badge2">当天快修</li>
              <li data-i18n="hero_badge3">原厂级检测</li>
            </ul>
          </div>
          <div class="hero-media">
            <img src="./hero_garage.png" alt="整洁的绿色主题汽修车间与技师" />
          </div>
        </div>
      </section>

      <section id="services" class="section">
        <div class="container">
          <h2 class="section-title" data-i18n="services_title">服务项目</h2>
          <div class="grid services-grid">
            <article class="card">
              <img src="./service_maintenance.png" alt="保养图标" />
              <h3 data-i18n="svc_maint_title">保养服务</h3>
              <p data-i18n="svc_maint_desc">更换机油三滤、全车检查、电脑诊断。</p>
            </article>
            <article class="card">
              <img src="./service_engine.png" alt="发动机图标" />
              <h3 data-i18n="svc_engine_title">发动机/变速箱</h3>
              <p data-i18n="svc_engine_desc">疑难故障检修、动力系统维护与翻新。</p>
            </article>
            <article class="card">
              <img src="./service_brake.png" alt="刹车图标" />
              <h3 data-i18n="svc_brake_title">刹车与底盘</h3>
              <p data-i18n="svc_brake_desc">刹车片/盘更换、减震与悬架校正。</p>
            </article>
            <article class="card">
              <img src="./service_tire.png" alt="轮胎图标" />
              <h3 data-i18n="svc_tire_title">轮胎与四轮定位</h3>
              <p data-i18n="svc_tire_desc">轮胎更换、动平衡、四轮定位。</p>
            </article>
            <article class="card">
              <img src="./service_ev.png" alt="新能源图标" />
              <h3 data-i18n="svc_ev_title">新能源专项</h3>
              <p data-i18n="svc_ev_desc">高压系统检测、电池健康评估。</p>
            </article>
          </div>
        </div>
      </section>

      <section id="booking" class="section section-accent">
        <div class="container">
          <h2 class="section-title" data-i18n="booking_title">在线预约</h2>
          <form id="booking-form" class="form card" novalidate>
            <div class="form-row">
              <label>
                <span data-i18n="form_name_label">姓名</span>
                <input type="text" name="name" required placeholder="您的姓名" data-i18n-placeholder="form_name_ph" />
              </label>
              <label>
                <span data-i18n="form_phone_label">手机</span>
                <input type="tel" name="phone" required placeholder="例如 13800000000" pattern="^\\s*1\\d{10}\\s*$" data-i18n-placeholder="form_phone_ph" />
              </label>
            </div>
            <div class="form-row">
              <label>
                <span data-i18n="form_car_label">车型</span>
                <input type="text" name="car" required placeholder="品牌 / 车型 / 年款" data-i18n-placeholder="form_car_ph" />
              </label>
              <label>
                <span data-i18n="form_date_label">日期</span>
                <input type="date" name="date" required />
              </label>
            </div>
            <label>
              <span data-i18n="form_service_label">服务类型</span>
              <select name="service" required>
                <option value="" disabled selected data-i18n="form_service_opt_placeholder">请选择</option>
                <option data-i18n="form_service_opt_maint">保养服务</option>
                <option data-i18n="form_service_opt_engine">发动机/变速箱</option>
                <option data-i18n="form_service_opt_brake">刹车与底盘</option>
                <option data-i18n="form_service_opt_tire">轮胎与四轮定位</option>
                <option data-i18n="form_service_opt_ev">新能源专项</option>
              </select>
            </label>
            <label>
              <span data-i18n="form_note_label">备注</span>
              <textarea name="note" rows="3" placeholder="简单描述您的需求或故障现象" data-i18n-placeholder="form_note_ph"></textarea>
            </label>
            <div class="form-actions">
              <button class="btn btn-primary" type="submit" data-i18n="form_submit">提交预约</button>
              <p id="form-status" role="status" aria-live="polite"></p>
            </div>
          </form>
        </div>
      </section>

      <section id="about" class="section">
        <div class="container about-grid">
          <div>
            <h2 class="section-title" data-i18n="about_title">关于 T&D Autocare</h2>
            <p data-i18n="about_desc">我们是一家以"专业、透明、守时"为宗旨的现代化汽修中心。团队拥有10年以上品牌4S店经验，配备原厂级诊断设备与工装，严格执行标准化流程。</p>
            <ul class="list-check">
              <li data-i18n="about_check1">标准化接车与复检</li>
              <li data-i18n="about_check2">维修过程全程可视</li>
              <li data-i18n="about_check3">配件来源可追溯</li>
            </ul>
          </div>
          <div class="stats">
            <div class="stat">
              <span class="num" data-count="5000">0</span>
              <span class="label" data-i18n="stats_label_vehicles">+ 累计服务车辆</span>
            </div>
            <div class="stat">
              <span class="num" data-count="98">0</span>
              <span class="label" data-i18n="stats_label_satisfaction">% 客户满意度</span>
            </div>
            <div class="stat">
              <span class="num" data-count="12">0</span>
              <span class="label" data-i18n="stats_label_experience">年 行业经验</span>
            </div>
          </div>
        </div>
      </section>

      <section id="contact" class="section">
        <div class="container contact-grid">
          <div>
            <h2 class="section-title" data-i18n="contact_title">联系我们</h2>
            <ul class="contact-list">
              <li><strong data-i18n="contact_phone_label">电话：</strong><a href="tel:+61297928828">+61 2 9792 8828</a></li>
              <li><strong data-i18n="contact_address_label">地址：</strong><span data-i18n="contact_address">78 Gibson Ave, Padstow NSW 2211, Australia</span></li>
              <li><strong data-i18n="contact_hours_label">营业时间：</strong>
                <ul>
                  <li data-i18n="contact_hours_monfri">Monday – Friday: 9:00 AM – 5:00 PM</li>
                  <li data-i18n="contact_hours_sat">Saturday: 9:00 AM – 2:00 PM</li>
                  <li data-i18n="contact_hours_sun">Sunday: Closed</li>
                </ul>
              </li>
              <li><strong data-i18n="contact_payment_label">支付方式：</strong><span data-i18n="contact_payment">Apple Pay，及主要银行卡</span></li>
            </ul>
            <a class="btn btn-outline" href="#booking" data-i18n="contact_cta">预约到店</a>
          </div>
          <div class="map-wrap">
            <iframe
              title="T&D Autocare Location"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              src="https://www.google.com/maps?q=78+Gibson+Ave+Padstow+NSW+2211+Australia&output=embed">
            </iframe>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <a href="#" class="brand small">
          <img src="./logo.png" alt="T&D Autocare Logo" class="brand-logo" />
          <span class="brand-name">T&D Autocare</span>
        </a>
        <p>© <span id="year"></span> T&D Autocare | <span data-i18n="footer_tagline">诚信经营 · 专业服务</span></p>
        <ul class="footer-links">
          <li><a href="#services" data-i18n="footer_services">服务</a></li>
          <li><a href="#about" data-i18n="footer_about">关于</a></li>
          <li><a href="#contact" data-i18n="footer_contact">联系</a></li>
          <li><a href="#booking" data-i18n="footer_booking">预约</a></li>
        </ul>
      </div>
    </footer>

    <!-- ✅ 新增：Supabase 写入逻辑 -->
    <script type="module">
      const supabaseUrl = 'https://mgrorhbschtyrdrekfhb.supabase.co';
      const supabaseKey = 'sb_publishable_bbYg4Bl2F5uHC_3XqdH2RA_NOnp3wfc';
      const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

      const bookingForm = document.getElementById('booking-form');
      const statusEl = document.getElementById('form-status');
      const yearEl = document.getElementById('year');
      yearEl.textContent = new Date().getFullYear();

      bookingForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        statusEl.textContent = '提交中，请稍候...';

        const formData = new FormData(bookingForm);
        const record = {
          date: formData.get('date'),
          time: '09:30:00',
          car: formData.get('car') || '未填写',
          mileage: '',
          plate: '',
          project: formData.get('service'),
          price: null,
          contact: `${formData.get('name')} / ${formData.get('phone')}`,
          note: formData.get('note') || ''
        };

        try {
          const { error } = await supabaseClient.from('tasks').insert([record]);
          if (error) throw error;
          statusEl.textContent = '✅ 提交成功！我们会尽快与您联系。';
          bookingForm.reset();
          setTimeout(() => (statusEl.textContent = ''), 3000);
        } catch (err) {
          console.error(err);
          statusEl.textContent = '❌ 提交失败，请稍后重试。';
        }
      });
    </script>

    <!-- 保留你原本的引用 -->
    <script type="module" src="./app.js"></script>
  </body>
</html>
